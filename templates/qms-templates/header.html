{# qms-templates/header.html #}
<header class="qms-header" role="banner">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <style>
    :root{
      --em-blue:#006EB3;
      --em-green:#5BC500;
      --text:#ffffff;
      --muted: rgba(255,255,255,.86);
      --line: rgba(255,255,255,.18);
      --shadow: 0 10px 28px rgba(0,0,0,.18);
      --h:72px;
      --container:1200px;
    }

    *{ box-sizing:border-box; }

    .qms-header{
      height:var(--h);
      background:linear-gradient(90deg,#006EB3,#0A84D6);
      color:var(--text);
      box-shadow:var(--shadow);
      position:sticky;
      top:0;
      z-index:100;
    }

    .qms-header .wrap{
      max-width:var(--container);
      height:100%;
      margin:0 auto;
      padding:0 18px;
      display:grid;
      grid-template-columns:auto 1fr auto;
      align-items:center;
      gap:18px;
    }

    /* ================= Brand ================= */
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      white-space:nowrap;
    }

    .brand .logo{
      width:40px;
      height:40px;
      border-radius:12px;
      background:rgba(255,255,255,.18);
      display:grid;
      place-items:center;
      font-weight:900;
      font-size:18px;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.28);
    }

    .brand .txt{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }

    .brand .title{
      font-size:15px;
      font-weight:800;
      color:#fff;
    }

    .brand .sub{
      font-size:12px;
      opacity:.9;
      color:rgba(255,255,255,.88);
    }

    /* ================= Nav ================= */
    .nav{
      display:flex;
      justify-content:center;
      align-items:center;
      gap:14px;
    }

    .nav a{
      position:relative;
      width:40px;
      height:40px;
      display:grid;
      place-items:center;
      color:#fff;
      border-radius:12px;
      background:rgba(255,255,255,.14);
      border:1px solid var(--line);
      text-decoration:none;
      font-size:18px;
      transition:.15s ease;
    }

    .nav a:hover{
      background:rgba(255,255,255,.25);
      transform:translateY(-2px);
    }

    .nav a.is-active{
      background:rgba(255,255,255,.28);
      box-shadow:0 10px 18px rgba(0,0,0,.12);
      border-color: rgba(255,255,255,.30);
    }

    /* Tooltip */
    .nav a::after{
      content:attr(data-label);
      position:absolute;
      bottom:-34px;
      left:50%;
      transform:translateX(-50%);
      background:#0B1220;
      color:#fff;
      font-size:11px;
      padding:6px 9px;
      border-radius:8px;
      white-space:nowrap;
      opacity:0;
      pointer-events:none;
      transition:.15s;
    }

    .nav a:hover::after{
      opacity:1;
      bottom:-38px;
    }

    /* Add Button (Enterprise) */
    .nav .add-btn{
      background:var(--em-green);
      border:1px solid rgba(255,255,255,.4);
      font-weight:900;
    }

    .nav .add-btn:hover{
      background:#6edb00;
    }

    /* ================= Right Section ================= */
    .right{
      display:flex;
      align-items:center;
      gap:12px;
    }

    /* Search */
    .search{
      position:relative;
      width:240px;
    }

    .search input{
      width:100%;
      height:38px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.18);
      color:#fff;
      padding:0 14px 0 36px;
      font-size:13px;
      outline:none;
    }

    .search input::placeholder{
      color:rgba(255,255,255,.85);
    }

    .search .icon{
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      font-size:14px;
    }

    /* User Box */
    .user{
      display:flex;
      align-items:center;
      gap:10px;
      padding:6px 10px;
      border-radius:999px;
      background:#ffffff;
      border:1px solid rgba(255,255,255,.35);
      box-shadow:0 10px 18px rgba(0,0,0,.10);
      max-width:260px;
    }

    .avatar{
      width:32px;
      height:32px;
      border-radius:999px;
      background:rgba(0,110,179,.12);
      color:#006EB3;
      display:grid;
      place-items:center;
      font-weight:900;
      font-size:14px;
    }

    .uinfo{
      display:flex;
      flex-direction:column;
      line-height:1.05;
      overflow:hidden;
    }

    .uinfo .name{
      font-size:13px;
      font-weight:800;
      color:#0B1220;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .uinfo .dept{
      font-size:11.5px;
      color:rgba(11,18,32,.68);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Logout */
    .logout{
      width:40px;
      height:38px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.14);
      color:#fff;
      display:grid;
      place-items:center;
      cursor:pointer;
      transition:.15s ease;
    }

    .logout:hover{
      background:rgba(255,255,255,.22);
      transform:translateY(-1px);
    }
      /* Admin (superuser only) */
    .admin-btn{
      height:38px;
      padding:0 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.14);
      color:#fff;
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      font-weight:800;
      font-size:12px;
      transition:.15s ease;
    }

    .admin-btn:hover{
      background:rgba(255,255,255,.22);
      transform:translateY(-1px);
    }

    @media (max-width:1024px){
      .admin-btn{ display:none; } /* اختياري: اخفاء في الموبايل */
    }
    /* Responsive */
    .menu-btn{
      display:none;
      width:40px;
      height:38px;
      border-radius:12px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.16);
      color:#fff;
      font-size:18px;
      cursor:pointer;
    }

    @media (max-width: 1024px){
      .nav{ display:none; }
      .search{ display:none; }
      .menu-btn{ display:inline-grid; place-items:center; }
    }

  </style>

  <div class="wrap">

    <!-- Brand -->
    <a class="brand" href="{% url 'core:home' %}" style="text-decoration:none;color:inherit;">
      <div class="logo">Q</div>
      <div class="txt">
        <div class="title">Quality Document Management</div>
        <div class="sub">Digital • Paperless • Secure</div>
      </div>
    </a>

    <!-- Navigation -->
    <nav class="nav">

  <!-- Home -->
  <a href="{% url 'core:home' %}" data-label="Home"
     class="{% if request.resolver_match.url_name == 'home' %}is-active{% endif %}">
    <i class="bi bi-house"></i>
  </a>

  <!-- Documents -->
  <a href="{% url 'documents:list' %}" data-label="Documents"
     class="{% if request.resolver_match.app_name == 'documents' %}is-active{% endif %}">
    <i class="bi bi-folder2-open"></i>
  </a>

  {% if can_add_document %}
    <!-- ➕ Add Document (بنفس تنسيق الأيقونات) -->
    <a href="{% url 'documents:create' %}" data-label="Add Document"
       class="{% if request.resolver_match.url_name == 'create' %}is-active{% endif %}">
      <i class="bi bi-plus-lg"></i>
    </a>
  {% endif %}

  {% if request.user.is_authenticated %}
    <a href="#" data-label="Notifications">
      <i class="bi bi-bell"></i>
    </a>

    <a href="#" data-label="Help">
      <i class="bi bi-question-circle"></i>
    </a>
  {% endif %}

</nav>
    <!-- Right -->
    <div class="right">

      <div class="search">
        <span class="icon"><i class="bi bi-search"></i></span>
        <input type="search" placeholder="Search documents..." />
      </div>

      <div class="user">
        <div class="avatar">
          {% if request.user.is_authenticated %}
            {{ request.user.username|first|upper }}
          {% else %}
            U
          {% endif %}
        </div>
        <div class="uinfo">
          <div class="name">
            {% if request.user.is_authenticated %}
              {{ request.user.username }}
            {% else %}
              User
            {% endif %}
          </div>
          <div class="dept">
            {% if request.user.is_authenticated and request.user.department %}
              {{ request.user.department.name }}
            {% else %}
              Department
            {% endif %}
          </div>
        </div>
      </div>
          {% if request.user.is_authenticated and request.user.is_superuser %}
      <a class="admin-btn" href="/admin/" title="Admin Panel">
        <i class="bi bi-gear"></i>
        Admin
      </a>
        {% endif %}

      {% if request.user.is_authenticated %}
        <form method="post" action="{% url 'core:logout' %}" style="margin:0;">
          {% csrf_token %}
          <button class="logout" type="submit" title="Logout" style="border:0;">
            <i class="bi bi-box-arrow-right"></i>
          </button>
        </form>
      {% else %}
        <a class="logout" href="{% url 'core:login' %}" title="Login">
          <i class="bi bi-box-arrow-in-right"></i>
        </a>
      {% endif %}

      <button class="menu-btn">☰</button>

    </div>

  </div>
</header>